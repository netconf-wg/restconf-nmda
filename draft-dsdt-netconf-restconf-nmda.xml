<?xml version='1.0'?>
<!DOCTYPE rfc SYSTEM "rfc2629.dtd">

<?rfc toc="yes"?>
<?rfc symrefs="yes"?>
<?rfc sortrefs="yes" ?>
<?rfc compact="yes"?>
<?rfc subcompact="no"?>
<?rfc linkmailto="no" ?>
<?rfc editing="no" ?>
<?rfc comments="yes" ?>
<?rfc inline="yes"?>
<?rfc rfcedstyle="yes"?>
<?rfc-ext allow-markup-in-artwork="yes" ?>
<?rfc-ext include-index="no" ?>
<!--<?rfc strict="no"?> -->

<rfc category="std"
     ipr="trust200902"
     docName="draft-dsdt-netconf-restconf-nmda-latest"
     updates="8040">
    <front>
        <title>RESTCONF Update to Support the NMDA</title>
        <author initials="M.B." surname="Bjorklund" fullname="Martin Bjorklund">
            <organization>Tail-f Systems</organization>
            <address>
                <email>mbj@tail-f.com</email>
            </address>
        </author>
        <author initials="J.S." surname="Schoenwaelder" fullname="Juergen Schoenwaelder">
            <organization>Jacobs University</organization>
            <address>
                <email>j.schoenwaelder@jacobs-university.de</email>
            </address>
        </author>
        <author initials="P.S." surname="Shafer" fullname="Phil Shafer">
            <organization>Juniper Networks</organization>
            <address>
                <email>phil@juniper.net</email>
            </address>
        </author>
        <author initials="K.W." surname="Watsen" fullname="Kent Watsen">
            <organization>Juniper Networks</organization>
            <address>
                <email>kwatsen@juniper.net</email>
            </address>
        </author>
        <author initials="R.W." surname="Wilton" fullname="Rob Wilton">
            <organization>Cisco Systems</organization>
            <address>
                <email>rwilton@cisco.com</email>
            </address>
        </author>
        <date/>
        <area>Operations</area>
        <workgroup>NETCONF Working Group</workgroup>
        <abstract>
          <t>This document updates RESTCONF <xref target="RFC8040"/> in order to
          support the Network Management Datastore Architecture (NMDA) defined in
          <xref target="I-D.ietf-netmod-revised-datastores"/>.</t>
        </abstract>
        <note title="Editorial Note (To be removed by RFC Editor)">
          <t>This draft contains many placeholder values that need to be replaced
          with finalized values at the time of publication.  This note summarizes
          all of the substitutions that are needed.  No other RFC Editor 
          instructions are specified elsewhere in this document.</t>

          <t>Artwork in this document contains shorthand references to drafts in 
          progress.  Please apply the following replacements:
            <list  style="symbols">
              <t><spanx style="verb">XXXX</spanx> --&gt; the assigned RFC value for this draft</t>
            </list>
          </t>
          <t>Artwork in this document contains placeholder values for the date of publication of this
          draft.  Please apply the following replacement:
            <list  style="symbols">
              <t><spanx style="verb">YYYY-MM-DD</spanx> --&gt; the publication date of this draft</t>
            </list>
          </t>
          <t>The following two Appendix sections are to be removed prior to publication:
            <list  style="symbols">
              <t>Appendix A.  Change Log</t>
            </list>
          </t>
        </note>

    </front>
    <middle>

      <section title="Introduction">
        <t>This document updates RESTCONF <xref target="RFC8040"/> in order to
        support the Network Management Datastore Architecture (NMDA) defined in
        <xref target="I-D.ietf-netmod-revised-datastores"/>.</t>
        <t>This solution presented in this document is backwards compatible with
        <xref target="RFC8040"/>.  This is achieved by it only adding new top-level
        resources, and thereby leaving the semantics of all existing resources
        alone.</t>
      </section>

      <section title="Requirements Language">
        <t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
        NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
        "MAY", and "OPTIONAL" in this document are to be interpreted as
        described in BCP 14 <xref target="RFC2119"/> <xref target="RFC8174"/>
        when, and only when, they appear in all capitals, as shown here.</t>
      </section>

      <section title="Conformance">
        <t>A RESTCONF server identifies that it supports NMDA by supporting
        the new top-level resource {+restconf}/datastores.  Clients MAY test
        if a server supports NMDA using either the HEAD or GET methods on 
        this resource.</t>
      </section>

      <section title="The {+restconf}/datastores Resource">

        <t>The top-level resource 'datastores' is used to both return a list
        of datastores supported by the server, as well as to act as a mount
        point for those datastores.</t>

        <section title="As a Listing of Supported Datastores">
          <t>A client MAY discover which datastores a server supports by querying
          the 'datastores' resource.  The data model for this resource is described
          in <xref target="datastores-yang"/>.  Note, 'datastores' is not prefixed
          by a module name because it is considered a native top-level resource in
          this context.
            <figure>
              <artwork><![CDATA[
          GET {+restconf}/datastores HTTP/1.1
          Accept application/yang-data+xml
]]></artwork>
            </figure>
          </t>
          <t>For example, the following shows the response for a server supporting
          &lt;unified&gt;, &lt;intended&gt;, &lt;operational&gt;, and a dynamic
          datastore called "ds-ephemeral".  Note here that the datastore values
          are identityrefs, and hence are scoped to the namespace of the module
          that defined the identity.
            <figure>
              <artwork><![CDATA[
     <datastores xmlns="urn:ietf:params:xml:ns:yang:ietf-restconf
                 xmlns:ds="urn:ietf:params:xml:ns:yang:ietf-datastores">
       <datastore>ds:unified</legacy>
       <datastore>ds:intended</datastore>
       <datastore>ds:operational</datastore>
       <datastore xmlns="urn:example:ds-ephemeral">ds-ephemeral</datastore>
     </datastores>
]]></artwork>
            </figure>
          </t>
        </section>

        <section title="As a Mount Point for Datastores">
          <t>Knowing which datastores a server supports, a client MAY interact with
          specific datastores using the resource path:
            <figure>
              <artwork><![CDATA[
  {+restconf}/datastores/<datastore>
]]></artwork>
            </figure>
          </t>
          <t>For datastores not defined in the "ietf-datastores" module, the datastore
          name MUST be prefixed by the module name it is defined in.  For instance, the
          resource locations for the datastores listed above are:
          <figure>
            <artwork><![CDATA[
  {+restconf}/datastores/unified
  {+restconf}/datastores/intended
  {+restconf}/datastores/operational
  {+restconf}/datastores/example-ds-ephemeral:ds-ephemeral
]]></artwork>
          </figure>
        </t>
        </section>
      </section>

      <section title="Protocol Operations">
        <t>All existing protocol operations defined in <xref target="RFC8040"/>
        for the {+restconf}/data resource are available for all of the new
        datastore resources with the following exceptions:
          <list  style="symbols">
            <t>Some datastores are read-only by nature (e.g., &lt;intended&gt;),
            and hence any attempt to modify these datastores will fail.</t>
            <t>Dynamic datastores are excluded, as each dynamic datastore
            definition needs to be reviewed for what protocol operations
            it supports.</t>
          </list>
        </t>

        <t>DISCUSS: New protocol operations...commit, confirm, save?</t>
      </section>

      <section title="The 'ietf-restconf-nmda' Module" anchor="datastores-yang">
        <t>
          <figure>
            <artwork><![CDATA[

<CODE BEGINS> file "ietf-restconf-nmda@YYYY-MM-DD.yang"

INSERT_TEXT_FROM_FILE(ietf-restconf-nmda@YYYY-MM-DD.yang)

<CODE ENDS>
]]></artwork>
          </figure>
        </t>
      </section>

      <section title="Security Considerations">
      </section>

      <section title="IANA Considerations">
      </section>

<!--
      <section title="Acknowledgements">
        <t>The authors would like to thank for following for
        lively discussions on list and in the halls (ordered
        by last name):</t>
     </section>
-->

    </middle>

    <back>
      <references title="Normative References">
        <?rfc include="reference.RFC.2119.xml"?>
        <?rfc include="reference.RFC.8040.xml"?>
        <?rfc include="reference.RFC.8174.xml"?>
        <?rfc include="reference.I-D.ietf-netmod-revised-datastores"?>
        <?rfc include="reference.I-D.nmdsdt-netconf-rfc7895bis"?>
      </references>
<!--
      <references title="Informative References">
      </references>
-->
    </back>

</rfc>

